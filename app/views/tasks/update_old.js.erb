<% if @task.block_id %>
	$("#block_<%=@task.block_id%> .task_padding").append("<%= escape_javascript(render :partial => "task_dark", :locals => {:task => @task, :index => 99}) %>");
	$("#block_<%=@task.block_id%> .task_padding").children().each(function(index, div){
										$("#"+div.id+ " .task_count_dark").html(index + 1);
									});
	<% if @task.must == true %>
		var must_time = $("#block_<%=@task.block_id%> span.must_time").text();
		var total_min = $("#block_<%=@task.block_id%> span.total_min").text();
		var must_time = must_time - <%= @task.min_duration %>
		var total_min = total_min - <%= @task.min_duration %>
		var total_max = $("#block_<%=@task.block_id%> span.total_max").text();
		var total_max = total_max - <%= @task.max_duration %>
		$("#block_<%=@task.block_id%> span.must_time").html(must_time);
		$("#block_<%=@task.block_id%> span.total_min").html(total_min);
		$("#block_<%=@task.block_id%> span.total_max").html(total_max);
	<% else %>
		var total_min = $("#block_<%=@task.block_id%> span.total_min").text();
		var total_min = total_min - <%= @task.min_duration %>
		$("#block_<%=@task.block_id%> span.total_min").html(total_min);
		var total_max = $("#block_<%=@task.block_id%> span.total_max").text();
		var total_max = total_max - <%= @task.max_duration %>
		$("#block_<%=@task.block_id%> span.total_max").html(total_max);
	<% end %>
<% else %>
$("#tasks-list").append("<%= escape_javascript(render :partial => "task", :locals => {:task => @task, :index => 99}) %>");
$('#tasks-list').children().each(function(index, div){
										$("#"+div.id+ " .task_count").html(index + 1);
									});
<% end %>