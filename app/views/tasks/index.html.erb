	<div id="sub_nav">
		<%= render '/groups/sub_nav' %>
	</div>


<div id="tasks-list">
	<% @tasks.each do |task| %>
		<div id="task_<%= task.id %>" class="task_wrap">
			<div class="task_drag">
				<%= link_to '', task_path(task, :task => { :must => false }), :method => :put, :class => 'must_on' if task.must == true %>
				<%= link_to '', task_path(task, :task => { :must => true }), :method => :put, :class => 'must_off' if task.must == false %>
				<%= link_to '', task_path(task, :task => { :complete => false }), :method => :put, :class => 'complete_on' if task.complete == true %>
				<%= link_to '', task_path(task, :task => { :complete => true }), :method => :put, :class => 'complete_off' if task.complete == false %>
				<%= editable_field task, :task, { :event => "dblclick", :onblur => "cancel", :width => "none", :height => "none" } %>
				<%= link_to '', block_create_path(task.id), :class => 'target' %>
				<%= link_to '', task_path(task), :method => :delete, :class => 'delete' %>
			</div>
			<div class="tabs">
				<span class="leverage_tab" rel="/task/leverage/<%=task.id%>">
					<span class="leverage_img"></span> 
					<span class="text"> <%= task.leverage %> </span>
				</span>
				<span class="duration_tab" rel="/task/duration/<%=task.id%>">
					<span class="duration_img"></span> 
					<span class="text"> <%= "#{task.duration} min" if task.duration %> </span>
				</span>
				<span class="schedule_tab" tid="<%= task.id %>">
					<%= form_for(task, :html => {:class => 'schedule_form'}) do |f| %>
						<%= f.text_field :scheduled, :autocomplete => :off, :id => "task_scheduled_#{task.id}", :class => "hidden task_scheduled" %>
					<% end %>
					<span class="text"> <%= task.scheduled %> </span>
				</span>
			</div>
		</div>
	<% end %>
</div>

<br><br>

<div id="blocks-list">
	<% @blocks.each do |block| %>
		<div id="block_<%= block.id %>" class="block_wrap">
			<div class="block_drag">
				<div class="block_title">
					<%= link_to '', block_path(block), :method => :delete, :class => 'delete' %>
					<h2 class="block_title_tasks">Massive Action Plan</h2>
					<h2 class="block_title_outcome">Result / Outcome</h2>
					<h2 class="block_title_purpose">Purpose</h2>
				</div>
				<div class="block_body">
					<div class="tasks"> 
						<div class="task_padding">
						<% block.tasks.order_by([:sort, :asc]).each do |task| %>
							<div id="task_<%= task.id %>" class="task_wrap">
								<div class="task_drag">
									<%= link_to '', task_path(task, :task => { :must => false }), :method => :put, :class => 'must_on' if task.must == true %>
									<%= link_to '', task_path(task, :task => { :must => true }), :method => :put, :class => 'must_off' if task.must == false %>
									<%= link_to '', task_path(task, :task => { :complete => false }), :method => :put, :class => 'complete_on' if task.complete == true %>
									<%= link_to '', task_path(task, :task => { :complete => true }), :method => :put, :class => 'complete_off' if task.complete == false %>
									<%= editable_field task, :task, { :event => "dblclick", :onblur => "cancel", :width => "none", :height => "none" } %>
									<%= link_to '', task_path(task), :method => :delete, :class => 'delete' %>
								</div>
								<div class="tabs">
									<span class="leverage_tab" rel="/task/leverage/<%=task.id%>">
										<span class="leverage_img"></span> 
										<span class="text"> <%= task.leverage %> </span>
									</span>
									<span class="duration_tab" rel="/task/duration/<%=task.id%>">
										<span class="duration_img"></span> 
										<span class="text"> <%= "#{task.duration} min" if task.duration %> </span>
									</span>
									<span class="schedule_tab" tid="<%= task.id %>">
										<%= form_for(task, :html => {:class => 'schedule_form'}) do |f| %>
											<%= f.text_field :scheduled, :autocomplete => :off, :id => "task_scheduled_#{task.id}", :class => "hidden task_scheduled" %>
										<% end %>
										<span class="text"> <%= task.scheduled %> </span>
									</span>
								</div>
							</div>
						<% end %>
						<%= form_for(Task.new) do |f| %>
								<%= f.text_field :task, :autocomplete => :off, :id => "task_task_#{block.id}", :value => "New task...", :onfocus => '(this.value == "New task...") ? this.value = "" : this.value', :onblur => '(this.value == "") ? this.value = "New task..." : this.value' %>
								<%= f.hidden_field :block_id, :value => block.id %>
								<%= f.hidden_field :sort, :value => '99' %>
						<% end %>
						</div>
					</div>
					<div class="outcome"> 
						<div class="outcome_padding">
							<%= editable_field block, :outcome, { :event => "dblclick", :onblur => "cancel", :width => "none", :height => "none" } %>
						</div>
					</div>
					<div class="purpose"> 
						<div class="purpose_padding">
						<%= editable_field block, :purpose, { :event => "dblclick", :onblur => "cancel", :width => "none", :height => "none" } %>
						</div>
					</div>
				</div>
			</div>
		</div>
	<% end %>
</div>